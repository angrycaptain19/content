commonfields:
  id: CrowdStrike Falcon Sandbox V2
  version: -1
name: CrowdStrike Falcon Sandbox V2
display: CrowdStrike Falcon Sandbox v2
category: Forensics & Malware Analysis
description: Fully automated malware analysis (formerly Payload Security VxStream).
configuration:
  - name: serverUrl
    display: Server URL (e.g. https://216.3.128.82)
    required: true
    defaultvalue: https://www.hybrid-analysis.com/api/v2
    type: 0
    additionalinfo: null
  - name: credentials
    display: User Name
    required: false
    defaultvalue: null
    type: 9
    additionalinfo: API key is required only to add a comment to a malware sample.
    displaypassword: API Key
    hiddenusername: true
  - name: insecure
    display: Trust any certificate (not secure)
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: null
  - name: proxy
    display: Use system proxy settings
    required: false
    defaultvalue: "true"
    type: 8
    additionalinfo: null
script:
  script: "-"
  subtype: python3
  type: python
  dockerimage: demisto/python3:3.9.9.25564
  commands:
    - name: cs-falcon-sandbox-scan
      arguments:
        - name: file
          description: File hash (MD5, SHA1 or SHA256)
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs:
        - contextPath: File.SHA256
          description: SHA256 of the file
          type: string
        - contextPath: File.SHA1
          description: SHA1 of the file
          type: string
        - contextPath: File.MD5
          description: MD5 of the file
          type: string
        - contextPath: File.environmentId
          description: Environment id of the file
          type: string
        - contextPath: File.analysis_start_time
          description: Analysis start time of the file
          type: string
        - contextPath: File.submitname
          description: Submission name of the file
          type: string
        - contextPath: File.classification_tags
          description: List of classification tags of the file
        - contextPath: File.vxfamily
          description: Family classification of the file
          type: string
        - contextPath: File.total_network_connections
          description: Total network connections of the file
          type: number
        - contextPath: File.total_processes
          description: Total processes count of the file
          type: number
        - contextPath: File.total_signatures
          description: Total signatures count if the file
          type: number
        - contextPath: File.hosts
          description: List of file's hosts
        - contextPath: File.isinteresting
          description: If server found this file interesting
          type: boolean
        - contextPath: File.domains
          description: List of file's related domains
        - contextPath: File.isurlanalysis
          description: If file analyzed by url
          type: boolean
        - contextPath: File.Malicious.Vendor
          description: or malicious files, the vendor that made the decision
          type: string
        - contextPath: File.Malicious.Description
          description: For malicious files, the reason for the vendor to make the decision
          type: string
        - contextPath: DBotScore.Indicator
          description: The indicator we tested
          type: string
        - contextPath: DBotScore.Type
          description: The type of the indicator
          type: string
        - contextPath: DBotScore.Vendor
          description: Vendor used to calculate the score
          type: string
        - contextPath: DBotScore.Score
          description: The actual score
          type: number
        - contextPath: File.hash
          description: The hash used to query the file
          type: string
        - contextPath: File.state
          description: The state of the file test
          type: string
      description: Get summary information for a given MD5, SHA1 or SHA256 and all the
        reports generated for any environment ID
    - name: cs-falcon-sandbox-get-environments
      deprecated: false
      arguments: []
      outputs:
        - contextPath: CrowdStrike.Environment.ID
          description: Environment ID
          type: number
        - contextPath: CrowdStrike.Environment.description
          description: Environment description
          type: string
        - contextPath: CrowdStrike.Environment.architecture
          description: Environment architecture
          type: string
        - contextPath: CrowdStrike.Environment.VMs_total
          description: Total virtual machines in environment
          type: number
        - contextPath: CrowdStrike.Environment.VMs_busy
          description: Busy virtual machines in environment
          type: number
        - contextPath: CrowdStrike.Environment.analysisMode
          description: "Analysis mode of environment "
          type: string
        - contextPath: CrowdStrike.Environment.groupicon
          description: Icon of environment
          type: string
      description: Get a list of all available environments
    - name: cs-falcon-sandbox-submit-sample
      description: Submit a file from investigation to analysis server
      deprecated: false
      arguments:
        - name: entryId
          description: War room entry Id
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: environmentID
          description: 'Environment ID. Available environments ID: 300: "Linux (Ubuntu 16.04, 64 bit)"", 200: "Android Static Analysis", 120: "Windows 7 64 bit", 110: "Windows 7 32 bit (HWP Support)", 100: "Windows 7 32 bit"'
          required: true
          isArray: false
          auto: PREDEFINED
          defaultValue: ""
          predefined:
            - "100"
            - '110'
            - '120'
            - '200'
            - '300'
        - name: no_share_third_party
          description: "When set to 'true', the sample is never shared with any third party." 
          required: false
          isArray: false
          auto: PREDEFINED
          predefined:
            - 'true'
            - 'false'
        - name: no_hash_lookup
          description: "When set to 'true', the sample is never shared with any third party." 
          required: false
          isArray: false
          auto: PREDEFINED
          predefined:
            - 'true'
            - 'false'
        - name: allow_community_access
          description: "When set to 'true', the sample will be available for the community."
          required: false
          isArray: false
          auto: PREDEFINED
          predefined:
            - 'true'
            - 'false'
        - name: action_script
          description: "Optional custom runtime action script. Available runtime scripts: default, default_maxantievasion, default_randomfiles, default_randomtheme, default_openie"
          required: false
          isArray: false
          auto: PREDEFINED
          defaultValue: ""
          predefined:
            - default
            - default_maxantievasion
            - default_randomfiles
            - default_randomtheme
            - default_openie
        - name: hybrid_analysis
          description: When set to 'false', no memory dumps or memory dump analysis will take place.
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: experimental_anti_evasion
          description: "When set to 'true', will set all experimental anti-evasion options of the Kernelmode Monitor."
          required: false
          isArray: false
          defaultValue: ""
          auto: PREDEFINED
          predefined:
            - 'true'
            - 'false'
        - name: script_logging
          description: "When set to 'true', will set the in-depth script logging engine of the Kernelmode Monitor."
          required: false
          isArray: false
          defaultValue: ""
          auto: PREDEFINED
          predefined:
            - 'true'
            - 'false'
        - name: input_sample_tampering
          description: "When set to 'true', will allow experimental anti-evasion options of the Kernelmode Monitor that tamper with the input sample."
          required: false
          isArray: false
          defaultValue: ""
          auto: PREDEFINED
          predefined:
            - 'true'
            - 'false'
        - name: network_settings
          description: "Network settings, by the default, fully operating network is set. Available options: default: 'Fully operating network', tor: 'Route network traffic via TOR', simulated: 'Simulate network traffic'"
          required: false
          isArray: false
          defaultValue: ""
          auto: PREDEFINED
          predefined:
            - default
            - tor
            - simulated
        - name: email
          description: Optional E-Mail address that may be associated with the submission for notification
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: comment
          description: "Optional comment text that may be associated with the submission/sample (Note: you can use #tags here)"
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: custom_cmd_line
          description: Optional commandline that should be passed to the analysis file
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: custom_run_time
          description: Optional runtime duration (in seconds)
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: submit_name
          description: Optional runtime duration (in seconds)
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: priority
          description: 'Optional priority value between 1 (lowest) and 10 (highest), by default all samples run with highest priority'
          required: false
          isArray: false
          defaultValue: ""
          auto: PREDEFINED
          predefined:
            - '1'
            - '2'
            - '3'
            - '4'
            - '5'
            - '6'
            - '7'
            - '8'
            - '9'
            - '10'
        - name: document_password
          description: "Optional document password that will be used to fill-in Adobe/Office password prompts"
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: environment_variable
          description: "Optional system environment value. The value is provided in the format: name=value"
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: cs-falcon-sandbox-search
      description: Search the database using the Falcon Sandbox search syntax
      deprecated: false
      arguments:
        - name: query
          description: description
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: filename
          description: Filename e.g. invoice.exe
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: filetype
          description: "Available options: 64bits, android, assembly, bat, cmd, com, csv,
            data, doc, docx, elf, empty, executable, flash, html, hwp, hwpx,
            img, iqy, java, javascript, library, lnk, macho, mshelp, msi,
            native, neexe, office, outlook, pdf, pedll, peexe, perl, ppt, pptx,
            ps, pub, python, rtf, script, sct, sh, svg, text, url, vbe, vbs,
            wsf, xls, xlsx"
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: filetype_desc
          description: Filetype description e.g. PE32 executable
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: env_id
          description: Environment Id
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: country
          description: Country (3 digit ISO) e.g. swe
          required: false
          isArray: false
          defaultValue: ""
        - name: verdict
          description: description
          required: false
          isArray: false
          auto: PREDEFINED
          defaultValue: ""
          predefined:
            - Whitelisted
            - NoVerdict
            - NoSpecificThreat
            - Suspicious
            - Malicious
        - name: av_detect
          description: AV Multiscan range e.g. 50-70 (min 0, max 100)
          required: false
          isArray: false
          defaultValue: ""
          predefined: 
            - ""
        - name: vx_family
          description: AV Family Substring e.g. nemucod
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: tag
          description: Hashtag e.g. ransomware
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: date_from
          description: "Date from in format: 'Y-m-d H:i' e.g. 2018-09-28 15:30"
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: date_to
          description: "Date to in format: 'Y-m-d H:i' e.g. 2018-09-28 15:30"
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: port
          description: Port e.g. 8080
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: host
          description: Host e.g. 192.168.0.1
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: domain
          description: Domain e.g. checkip.dyndns.org
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: url
          description: HTTP Request Substring e.g. google
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: similar_to
          description: Similar Samples e.g. <sha256>
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: context
          description: Sample Context e.g. <sha256>
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: imp_hash
          description: description
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: ssdeep
          description: description
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: authentihash
          description: description
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: cs-falcon-sandbox-result
      description: Retrieve result data upon a file. NOTE - This command returns a file
      deprecated: false
      arguments:
        - name: file
          description: File hash (MD5, SHA1 or SHA256)
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: environmentID
          description: environment ID to submit file to(get all via
            crowdstrike-get-environments)
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: JobID
          description: Job ID of file to generate report for
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: file_type
          description: description
          required: false
          isArray: false
          auto: PREDEFINED
          defaultValue: ""
          predefined:
            - xml
            - json
            - html
            - pdf
            - maec
            - stix
            - misp
            - misp-json
            - openioc
            - ""
      outputs: []
    - name: cs-falcon-sandbox-detonate-file
      description: Detonate file through Falcon Sandbox
      deprecated: false
      arguments: []
      outputs: []
    - name: cs-falcon-sandbox-submit-url
      description: Submit a URL for analysis (Supported only in v2)
      deprecated: false
      arguments: []
      outputs: []
    - name: cs-falcon-sandbox-get-screenshots
      description: " Retrieves screenshots from a report"
      deprecated: false
      arguments:
        - name: file
          description: the sha256 hash of a file
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: environmentID
          description: description
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
        - name: JobID
          description: description
          required: false
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: cs-falcon-sandbox-detonate-url
      description: (Deprecated - Please use CrowdStrike Falcon Sandbox - Detonate URL
        playbook instead) Detonates URL address through Falcon Sandbox
        (supported only in v2)
      deprecated: true
      arguments: []
      outputs: []
    - name: cs-falcon-sandbox-analysis-overview
      description: get overview for hash
      deprecated: false
      arguments:
        - name: file
          description: The sha256 hash of a file
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs:
        - contextPath: CrowdStrike.AnalysisOverview
          description: description
          type: Unknown
    - name: cs-falcon-sandbox-analysis-overview-summary
      description: return overview for hash
      deprecated: false
      arguments:
        - name: file
          description: The sha256 hash of a file
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: cs-falcon-sandbox-analysis-overview-refresh
      description: refresh overview and download fresh data from external services
      deprecated: false
      arguments:
        - name: file
          description: The sha256 hash of a file
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
    - name: file
      description: todo put description
      arguments:
        - name: file
          default: true
          required: true
          description: List of files.
          isArray: true
      outputs: []
    - name: cs-falcon-sandbox-sample-download
      description: download sample file
      deprecated: false
      arguments:
        - name: file
          description: ""
          required: true
          isArray: false
          defaultValue: ""
          predefined:
            - ""
      outputs: []
  runonce: false
tests:
  - VxStream Test
  - Detonate File - Generic Test
fromversion: 5.5.0
